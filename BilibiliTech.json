{"title":"幻电物业 - B站技术中心","url":"https://space.bilibili.com/393183630/article","favicon":"https://space.bilibili.com/393183630/favicon.ico","elements":[{"title":"云厂商CDN故障后，连夜设计了云边端协同新方案","contents":"<a href=\"//www.bilibili.com/read/cv27753037\" target=\"_blank\" title=\"本期作者1、背景事件简述：2023年8月4日 21:00-21:20 云厂商 CDN 服务故障，回源流量突增导致 BFS SLB 过载，影响依赖图片、JS/CSS静态资源的服务，大量用户出现白屏和无法播放视频的问题。事件原因：因为云厂商 CDN 故障，自动执行域名下线策略，策略如下：解析回源：域名被下线时，域名会解析回主源站停用域名：域名被下线时，域名会被调整为”停用“状态，停止 CDN 加速服务，并且返回403解析回源策略，瞬间产生几百G的流量，”攻击”源站BFS服务，服务瘫痪停用域名策略，会造成大量用\">\n                      本期作者1、背景事件简述：2023年8月4日 21:00-21:20 云厂商 CDN 服务故障，回源流量突增导致 BFS SLB 过载，影响依赖图片、JS/CSS静态资源的服务，大量用户出现白屏和无法播放视频的问题。事件原因：因为云厂商 CDN 故障，自动执行域名下线策略，策略如下：解析回源：域名被下线时，域名会解析回主源站停用域名：域名被下线时，域名会被调整为”停用“状态，停止 CDN 加速服务，并且返回403解析回源策略，瞬间产生几百G的流量，”攻击”源站BFS服务，服务瘫痪停用域名策略，会造成大量用\n                    </a>","link":"https://www.bilibili.com/read/cv27753037","retrieved":1700501625978},{"title":"语聊房架构演进实践","contents":"<a href=\"//www.bilibili.com/read/cv27682252\" target=\"_blank\" title=\"本期作者序言罗马不是一天建成的。语聊房当前架构也是不断演进的结果。在技术架构层面，语聊房作为搭建在直播体系上的业务，使用既有技术架构体系可以帮助我们快速搭建早期产品，但随着业务迭代，已有技术体系又成为新的技术架构的负债。同样在业务架构层面，语聊房产品已经迭代一年，产品形态依然在快速变化，已有的业务架构又会成为新的业务架构的阻碍。每一次产品需求的迭代，都会对已有技术架构和业务架构造成双重冲击。本文将结合语聊房持续演进的过程，谈谈业务视角下的架构演进。以及如何构建能应对各种变化的系统，不断达到新的平衡。语聊房\">\n                      本期作者序言罗马不是一天建成的。语聊房当前架构也是不断演进的结果。在技术架构层面，语聊房作为搭建在直播体系上的业务，使用既有技术架构体系可以帮助我们快速搭建早期产品，但随着业务迭代，已有技术体系又成为新的技术架构的负债。同样在业务架构层面，语聊房产品已经迭代一年，产品形态依然在快速变化，已有的业务架构又会成为新的业务架构的阻碍。每一次产品需求的迭代，都会对已有技术架构和业务架构造成双重冲击。本文将结合语聊房持续演进的过程，谈谈业务视角下的架构演进。以及如何构建能应对各种变化的系统，不断达到新的平衡。语聊房\n                    </a>","link":"https://www.bilibili.com/read/cv27682252","retrieved":1700501625980},{"title":"多容器动态化方案在游戏SDK中的实践","contents":"<a href=\"//www.bilibili.com/read/cv27603061\" target=\"_blank\" title=\"本期作者一、前言从产品运营角度来说，功能的用户触达是实现用户价值转化的最基本前提。所以如何快速将一个新的功能触达到用户，同时减少触达过程中对运营推广、用户带来额外的成本就成了一个必须被重视的课题。对于APP而言，以一个相对固定的节奏进行版本迭代，在一个迭代周期内，新版本基本可以达到一个相对较高的覆盖率。但对SDK而言，因为其并非直接面向用户，更像是一个ToB类产品，快速的版本迭代显然不是一个有效的途径，游戏SDK也不例外。二、背景与目标2.1 “三座大山”周期长，游戏SDK的功能触达用户需要一个月左右的时\">\n                      本期作者一、前言从产品运营角度来说，功能的用户触达是实现用户价值转化的最基本前提。所以如何快速将一个新的功能触达到用户，同时减少触达过程中对运营推广、用户带来额外的成本就成了一个必须被重视的课题。对于APP而言，以一个相对固定的节奏进行版本迭代，在一个迭代周期内，新版本基本可以达到一个相对较高的覆盖率。但对SDK而言，因为其并非直接面向用户，更像是一个ToB类产品，快速的版本迭代显然不是一个有效的途径，游戏SDK也不例外。二、背景与目标2.1 “三座大山”周期长，游戏SDK的功能触达用户需要一个月左右的时\n                    </a>","link":"https://www.bilibili.com/read/cv27603061","retrieved":1700501625981},{"title":"BVT：高性能多媒体算法推理基座","contents":"<a href=\"//www.bilibili.com/read/cv27532510\" target=\"_blank\" title=\"本期作者1 前言随着人工智能技术的快速发展，B站已经有非常多的AI算法可以用来助力多媒体业务，诸如超分辨率、人脸增强、视频插帧、窄带高清等等。如今，以扩散模型（Stable Diffusion）和大语言模型（LLM）掀起的生成式AI浪潮又给多媒体业务带来了更多技术可能。相对于各类AI算法模型的研发，模型推理与视频处理框架在多媒体业务部署中的重要性更为凸显，是工程化”基座“的存在。一个优秀的多媒体AI算法工程化框架，不仅可以提供更高的运行性能、异构计算及多平台支持等功能，同时也增加代码复用率，提升开发效率，\">\n                      本期作者1 前言随着人工智能技术的快速发展，B站已经有非常多的AI算法可以用来助力多媒体业务，诸如超分辨率、人脸增强、视频插帧、窄带高清等等。如今，以扩散模型（Stable Diffusion）和大语言模型（LLM）掀起的生成式AI浪潮又给多媒体业务带来了更多技术可能。相对于各类AI算法模型的研发，模型推理与视频处理框架在多媒体业务部署中的重要性更为凸显，是工程化”基座“的存在。一个优秀的多媒体AI算法工程化框架，不仅可以提供更高的运行性能、异构计算及多平台支持等功能，同时也增加代码复用率，提升开发效率，\n                    </a>","link":"https://www.bilibili.com/read/cv27532510","retrieved":1700501625983},{"title":"B站KAFKA探索与实践","contents":"<a href=\"//www.bilibili.com/read/cv27467636\" target=\"_blank\" title=\"本期作者1.背景Kafka 是我们公司各个部门的重要数据中间件，主要用于上报、暂存和分发各种数据。我们不仅支持大数据场景，同时也保障在线场景的稳定性。我们拥有1000+台Kafka机器，组成了20多个集群，针对不同业务场景配置了不同规格的机器，磁盘类型包括HDD，SSD和NVME。每日PB级输入，输出数十PB，肩负着公司数据传输的重任。随着集群规模的扩张，我们也遇到了越来越多的挑战。2.面临的挑战与痛点客户端的读写方式多种多样，难以预测，集群的稳定性和资源利用率难以协调。过高的读写操作可能会导致机器磁盘I\">\n                      本期作者1.背景Kafka 是我们公司各个部门的重要数据中间件，主要用于上报、暂存和分发各种数据。我们不仅支持大数据场景，同时也保障在线场景的稳定性。我们拥有1000+台Kafka机器，组成了20多个集群，针对不同业务场景配置了不同规格的机器，磁盘类型包括HDD，SSD和NVME。每日PB级输入，输出数十PB，肩负着公司数据传输的重任。随着集群规模的扩张，我们也遇到了越来越多的挑战。2.面临的挑战与痛点客户端的读写方式多种多样，难以预测，集群的稳定性和资源利用率难以协调。过高的读写操作可能会导致机器磁盘I\n                    </a>","link":"https://www.bilibili.com/read/cv27467636","retrieved":1700501625984},{"title":"上交胡强老师受邀分享生成式智能媒体的最新进展","contents":"<a href=\"//www.bilibili.com/read/cv27422109\" target=\"_blank\" title=\"今年B站1024程序员节，举办了一场别开生面的B站技术主题分享演讲活动。在分享会现场，特别邀请到多位重量级技术嘉宾阵容亲临，与程序员小伙伴分享技术知识，共同探讨应用与趋势。在元宇宙和生成式智能媒体技术方向，我们有幸邀请到了上海交通大学未来媒体网络协同创新中心的胡强老师，亲临公司为B站小伙伴分享了该领域内的最新进展。胡强老师所在团队与中央广播电视总台国重实验室紧密合作，他还担任 8K 3D视频增强制作及显示项目负责人，在该领域有丰富的科研和实践经验，下面是胡强老师精彩的分享内容。大家好，非常感谢B站的邀请，\">\n                      今年B站1024程序员节，举办了一场别开生面的B站技术主题分享演讲活动。在分享会现场，特别邀请到多位重量级技术嘉宾阵容亲临，与程序员小伙伴分享技术知识，共同探讨应用与趋势。在元宇宙和生成式智能媒体技术方向，我们有幸邀请到了上海交通大学未来媒体网络协同创新中心的胡强老师，亲临公司为B站小伙伴分享了该领域内的最新进展。胡强老师所在团队与中央广播电视总台国重实验室紧密合作，他还担任 8K 3D视频增强制作及显示项目负责人，在该领域有丰富的科研和实践经验，下面是胡强老师精彩的分享内容。大家好，非常感谢B站的邀请，\n                    </a>","link":"https://www.bilibili.com/read/cv27422109","retrieved":1700501625985},{"title":"游戏全球发行平台的实践与探索","contents":"<a href=\"//www.bilibili.com/read/cv27309823\" target=\"_blank\" title=\"本期作者背景在全公司针对业务效率提升有严格要求的背景下，游戏技术中台一直在思考，如何提高全球发行效率？在游戏技术中台的众多产品当中，SDK是赋能游戏研发的核心产品之一，其核心能力包括账号、交易、合规（实名、防沉迷），以及社交、营销等能力。现有的SDK群存在22种类型，在过往的高速发展和历史惯性中，SDK群划分的维度主要有3个：发行品牌：bilibili、白板、D、海外bilibili、海外白板、K；（出于发行品牌隔离保护需要，下文以代号D/K分别代表国内和海外被保护的发行品牌）发行地区：中国大陆、繁中、韩\">\n                      本期作者背景在全公司针对业务效率提升有严格要求的背景下，游戏技术中台一直在思考，如何提高全球发行效率？在游戏技术中台的众多产品当中，SDK是赋能游戏研发的核心产品之一，其核心能力包括账号、交易、合规（实名、防沉迷），以及社交、营销等能力。现有的SDK群存在22种类型，在过往的高速发展和历史惯性中，SDK群划分的维度主要有3个：发行品牌：bilibili、白板、D、海外bilibili、海外白板、K；（出于发行品牌隔离保护需要，下文以代号D/K分别代表国内和海外被保护的发行品牌）发行地区：中国大陆、繁中、韩\n                    </a>","link":"https://www.bilibili.com/read/cv27309823","retrieved":1700501625987},{"title":"常用性能优化手段及在风控系统中的应用","contents":"<a href=\"//www.bilibili.com/read/cv27279476\" target=\"_blank\" title=\"本期作者引言性能优化是个恒久的话题，随着产品的演进，业务的增长，系统能力总有达到瓶颈的一天，它不可或缺的陪伴着我们走向壮大再走向衰败，是我们面临的不可回避的问题。下图1展示了风控系统近半年来承载流量的增长趋势，可见最近半年来流量高速增长，且对于可预见的未来而言，接入流量还会持续高增。伴随着流量的增长，系统各方面--存储、计算、IO等都表现出一定的瓶颈，通过原始简单的水平扩容并不能解决所有的问题，而且还会带来成本的上升。因此，我们近期对系统进行了一系列优化改造， 目的是满足未来一段时间内业务的增长使用，降低\">\n                      本期作者引言性能优化是个恒久的话题，随着产品的演进，业务的增长，系统能力总有达到瓶颈的一天，它不可或缺的陪伴着我们走向壮大再走向衰败，是我们面临的不可回避的问题。下图1展示了风控系统近半年来承载流量的增长趋势，可见最近半年来流量高速增长，且对于可预见的未来而言，接入流量还会持续高增。伴随着流量的增长，系统各方面--存储、计算、IO等都表现出一定的瓶颈，通过原始简单的水平扩容并不能解决所有的问题，而且还会带来成本的上升。因此，我们近期对系统进行了一系列优化改造， 目的是满足未来一段时间内业务的增长使用，降低\n                    </a>","link":"https://www.bilibili.com/read/cv27279476","retrieved":1700501625990},{"title":"猫耳 Android 播放框架开发实践","contents":"<a href=\"//www.bilibili.com/read/cv27171599\" target=\"_blank\" title=\"本期作者概述猫耳FM是中国最大的 95 后声音内容分享平台，是B站重要平台之一，深度合作国内顶级声优工作室，打造了数百部精品广播剧，全站播放总量超过百亿次。MEPlayer 是猫耳 Android 技术团队研发的一款适用于音视频、直播、特效播放等多种场景的跨进程播放框架。目前支持：音视频、直播、特效播放。支持自定义播放内核，目前内置了 exo、bbp（多媒体部门开发的轻量级播放内核），都添加了边下边播支持，可以自行扩展支持 ijk 等内核，实现固定的几个接口即可。与业务完全解耦，已在公司内多个团队使用。跨\">\n                      本期作者概述猫耳FM是中国最大的 95 后声音内容分享平台，是B站重要平台之一，深度合作国内顶级声优工作室，打造了数百部精品广播剧，全站播放总量超过百亿次。MEPlayer 是猫耳 Android 技术团队研发的一款适用于音视频、直播、特效播放等多种场景的跨进程播放框架。目前支持：音视频、直播、特效播放。支持自定义播放内核，目前内置了 exo、bbp（多媒体部门开发的轻量级播放内核），都添加了边下边播支持，可以自行扩展支持 ijk 等内核，实现固定的几个接口即可。与业务完全解耦，已在公司内多个团队使用。跨\n                    </a>","link":"https://www.bilibili.com/read/cv27171599","retrieved":1700501625991},{"title":"B站视频模板的前世今生","contents":"<a href=\"//www.bilibili.com/read/cv27103118\" target=\"_blank\" title=\"本期作者一、前言1.创作的本质是什么从剪辑工具的角度，可以将创作拆解为主题、素材、剪辑三个要素主题：对应的品类 &amp; 风格，比如游戏、影视、泛生活等素材：用户使用的视频、音频、图片等内容剪辑：对素材进行时间、空间、效果上的调整，比如裁剪、复制、滤镜、转场、特效等视频模板恰好覆盖了创作的三个要素，限定「主题」和「剪辑手法」，允许用户填入部分「自定义素材」，降低用户创作门槛，实现B站的供增需求，从而辅助达成用增的目标2.B站视频模板的迭代历程竞品使用视频模板完成了大规模的起量，B站也在该领域进行不断的探索和迭代\">\n                      本期作者一、前言1.创作的本质是什么从剪辑工具的角度，可以将创作拆解为主题、素材、剪辑三个要素主题：对应的品类 &amp; 风格，比如游戏、影视、泛生活等素材：用户使用的视频、音频、图片等内容剪辑：对素材进行时间、空间、效果上的调整，比如裁剪、复制、滤镜、转场、特效等视频模板恰好覆盖了创作的三个要素，限定「主题」和「剪辑手法」，允许用户填入部分「自定义素材」，降低用户创作门槛，实现B站的供增需求，从而辅助达成用增的目标2.B站视频模板的迭代历程竞品使用视频模板完成了大规模的起量，B站也在该领域进行不断的探索和迭代\n                    </a>","link":"https://www.bilibili.com/read/cv27103118","retrieved":1700501625992},{"title":"基于多模态的视频高能点提取技术","contents":"<a href=\"//www.bilibili.com/read/cv27024849\" target=\"_blank\" title=\"本期作者1. 业务背景当用户在浏览B站时，首页所呈现的视频内容以卡片形式依序展示，这些视频卡片的封面大多数是与视频相关的静态图像。在制作视频时，up 主通常会选取视频中的某一帧并加上较为醒目的文案来制作封面；而电影和记录片则倾向于选择具有代表性的精彩帧画面作为封面展示。这种策略通过简洁、直观的封面设计，让用户在页面浏览的时候能迅速捕捉到视频的主题。图1.静态视频封面与仅能展示单帧画面的静态封面相比，动态视频封面会具有更多的优点，包括：更具吸引力和生动性：视频动态封面可以展示动态的画面、动作和效果，相比于静\">\n                      本期作者1. 业务背景当用户在浏览B站时，首页所呈现的视频内容以卡片形式依序展示，这些视频卡片的封面大多数是与视频相关的静态图像。在制作视频时，up 主通常会选取视频中的某一帧并加上较为醒目的文案来制作封面；而电影和记录片则倾向于选择具有代表性的精彩帧画面作为封面展示。这种策略通过简洁、直观的封面设计，让用户在页面浏览的时候能迅速捕捉到视频的主题。图1.静态视频封面与仅能展示单帧画面的静态封面相比，动态视频封面会具有更多的优点，包括：更具吸引力和生动性：视频动态封面可以展示动态的画面、动作和效果，相比于静\n                    </a>","link":"https://www.bilibili.com/read/cv27024849","retrieved":1700501625994},{"title":"挑战十万在播--直播全量在播分发系统","contents":"<a href=\"//www.bilibili.com/read/cv26960748\" target=\"_blank\" title=\"本期作者背景先说明下什么叫“全量在播”，指的是直播范围内，当前所有在线主播的信息，尤其是主播的房间id和uid，对于很多上游业务来说，是必要的数据，是业务逻辑的数据基础。直播之前虽然有一套这样的系统，但是从目前运行状态看并不能面向更高体量业务支撑，而且线上也因为这种过时的在播架构工作异常发生过几次线上事故。所以正如一本书所讲，如果不杀死任何系统，你会被僵尸包围。对于这种遗留系统需要做面向未来目标的设计。挑战面向未来的一两年我们有个很明确的目标，千万在线十万在播。其中后者十万在播，就是对于我们新的在播系统最\">\n                      本期作者背景先说明下什么叫“全量在播”，指的是直播范围内，当前所有在线主播的信息，尤其是主播的房间id和uid，对于很多上游业务来说，是必要的数据，是业务逻辑的数据基础。直播之前虽然有一套这样的系统，但是从目前运行状态看并不能面向更高体量业务支撑，而且线上也因为这种过时的在播架构工作异常发生过几次线上事故。所以正如一本书所讲，如果不杀死任何系统，你会被僵尸包围。对于这种遗留系统需要做面向未来目标的设计。挑战面向未来的一两年我们有个很明确的目标，千万在线十万在播。其中后者十万在播，就是对于我们新的在播系统最\n                    </a>","link":"https://www.bilibili.com/read/cv26960748","retrieved":1700501625995}]}